<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Relatix</title>
    <meta name="description" content="Relatix technical docs">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/relatix-docs/assets/style.BGHLwA9-.css" as="style">
    <link rel="preload stylesheet" href="/relatix-docs/vp-icons.css" as="style">
    
    <script type="module" src="/relatix-docs/assets/app.CDNlzvgE.js"></script>
    <link rel="preload" href="/relatix-docs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/relatix-docs/assets/chunks/theme.B1jtMkGw.js">
    <link rel="modulepreload" href="/relatix-docs/assets/chunks/framework.oxQ2x61N.js">
    <link rel="modulepreload" href="/relatix-docs/assets/fr_tables.md.DYrj6HwM.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/relatix-docs/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="relatix-logo.png" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>Relatix</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/relatixjs/relatix" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/relatixjs/relatix" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Relatix</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/relatix-docs/en/intro.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Intro</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/relatix-docs/en/workflow.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Workflow</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/relatix-docs/en/modeling.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Modeling</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/relatix-docs/en/usage.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Model Usage</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _relatix-docs_fr_tables" data-v-39a288b8><div><h1 id="relatix" tabindex="-1">Relatix <a class="header-anchor" href="#relatix" aria-label="Permalink to &quot;Relatix&quot;">​</a></h1><p><code>relatix</code> est une bibliothèque Typescript conçue pour faciliter la création et la manipulation de tables relationnelles. Elle simplifie la modélisation de données complexes en offrant une syntaxe claire et intuitive pour définir des tables interconnectées et les peupler de données cohérentes grâce à un typage fort de l&#39;état initial.</p><h2 id="workflow" tabindex="-1">Workflow <a class="header-anchor" href="#workflow" aria-label="Permalink to &quot;Workflow&quot;">​</a></h2><ol><li>Définition initiale des tables : Utilisez la fonction <code>Tables</code> avec un objet de configuration optionnel pour générer le constructeur de tables.</li><li>Ajout de tables : Chainez le constructeur avec la méthode .addTables pour créer un ensemble initial de tables</li><li>Ajout de tables supplémentaires : La méthode .addTables peut être chaînée autant de fois que nécessaire pour inclure des tables contenant des références vers les tables définies lors de ses appels précédents.</li><li>Population des données : Ajoutez des entrées aux tables avec la méthode .populate.</li><li>Finalisation : Appelez .done() pour obtenir un ensemble d&#39;utilitaires permettant d&#39;interagir avec le modèle.</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Tables</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> model</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#6A9955;">  // Paramétrisation de Tables</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#6A9955;">  // Ajout de tables indépendantes (références internes possibles)</span></span>
<span class="line"><span style="color:#D4D4D4;">})</span></span>
<span class="line"><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#6A9955;">  // Ajout de tables en référençant les tables existantes</span></span>
<span class="line"><span style="color:#D4D4D4;">})</span></span>
<span class="line"><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">populate</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">Table1</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Table2</span><span style="color:#D4D4D4;">, ... }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#6A9955;">  // Remplissage des tables avec des données concrètes</span></span>
<span class="line"><span style="color:#D4D4D4;">}))</span></span>
<span class="line"><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">done</span><span style="color:#D4D4D4;">();</span></span></code></pre></div><p><strong>Exemple</strong> :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">SelfRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Number</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> model</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#9CDCFE;">    People:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      name:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">      age:</span><span style="color:#9CDCFE;"> Number</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">      favouriteCoWorker:</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#C586C0;"> as</span><span style="color:#569CD6;"> typeof</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Projects:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    Tasks:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">assignedTo:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;People&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">project:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Projects&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">populate</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Projects</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    People:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      alice:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;Alice&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 25</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;bob&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#9CDCFE;">      bob:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;Bob&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 30</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#569CD6;"> null</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">      james:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;James&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 26</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;alice&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Projects:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      proj1:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#CE9178;"> &quot;Website Redesign&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#CE9178;"> &quot;Revamp company site&quot;</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Tasks:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      task1:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &quot;Design Homepage&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">        assignedTo:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;alice&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#9CDCFE;">        project:</span><span style="color:#DCDCAA;"> Projects</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;proj1&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#D4D4D4;">      },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">done</span><span style="color:#D4D4D4;">();</span></span></code></pre></div><h2 id="methodes-de-construction-du-modele" tabindex="-1">Méthodes de construction du modèle <a class="header-anchor" href="#methodes-de-construction-du-modele" aria-label="Permalink to &quot;Méthodes de construction du modèle&quot;">​</a></h2><h3 id="addtables-tablesconstructor" tabindex="-1"><code>.addTables(TablesConstructor)</code> <a class="header-anchor" href="#addtables-tablesconstructor" aria-label="Permalink to &quot;`.addTables(TablesConstructor)`&quot;">​</a></h3><p>La méthode <code>.addTables</code> chaînée à Tables accepte:</p><ul><li><p>un objet constructeur de tables :</p><ul><li>ses clés sont les noms des tables</li><li>ses valeurs des objets sérialisables dont chaque clé représente un champ, et chaque valeur décrit son type</li></ul><p>Les champs sont typés par inférence. Il est possible d&#39;ajouter des annotations de type explicites pour les cas plus complexes (ex. type union).</p></li><li><p>une fonction de <code>callback</code> dont le paramètre est un constructeur de référence, qui accepte une clé des tables précédemment définies, dont il permet de vérifier l&#39;existence et renvoie un constructeur de tables.</p></li></ul><h4 id="typers" tabindex="-1">Typers <a class="header-anchor" href="#typers" aria-label="Permalink to &quot;Typers&quot;">​</a></h4><p>Pour une meilleure compréhension de l&#39;intentionalité du code, <code>relatix</code> exporte des constantes typées pour décrire les champs : les <code>Typers</code>.</p><p>Le code :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> model</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">().</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#9CDCFE;">  People:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">    age:</span><span style="color:#9CDCFE;"> Number</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">    favouriteCoWorker:</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#C586C0;"> as</span><span style="color:#569CD6;"> typeof</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">  },</span></span>
<span class="line"><span style="color:#9CDCFE;">  Projects:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">});</span></span></code></pre></div><p>est exactement équivalent à :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#6A9955;">// typage par inférence grâce à des sample values</span></span>
<span class="line"><span style="color:#6A9955;">// ces valeurs servent uniquement à des fins de typage et ne sont pas réutilisées</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> model</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">().</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#9CDCFE;">  People:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;John&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 20</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">  Projects:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#CE9178;"> &quot;Some project&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#CE9178;"> &quot;Project description&quot;</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">});</span></span></code></pre></div><p>Dans les deux cas, les membres de <code>People</code> et <code>Projects</code> sont typés comme :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> People</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  name</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  age</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">number</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  favouriteCoWorker</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Project</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  title</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  description</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span></code></pre></div><p>La première version est cependant plus claire : elle évite de potentielles confusions sur le rôle des sample values.</p><p>Les <code>Typers</code> sont des constantes exportées par <code>tables</code> et leurs valeurs sont :</p><ul><li>Text: &quot;&quot;</li><li>Number: 1.0</li></ul><p>Pour une meilleure lisibilité et pour éviter toute ambiguïté, préférez toujours les Typers (Text, Number) aux valeurs d’exemple pour décrire le modèle de vos tables.</p><h4 id="selfref" tabindex="-1"><code>SelfRef</code> <a class="header-anchor" href="#selfref" aria-label="Permalink to &quot;`SelfRef`&quot;">​</a></h4><p>La constante <code>SelfRef</code> exportée depuis <code>relatix</code> permet d&#39;indiquer une référence d&#39;un champ de la table vers une autre instance de la même table.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">SelfRef</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span></code></pre></div><p>Dans <code>.populate</code> le champ <code>favouriteCoWorker</code> attendra une référence vers un autre membre de la table <code>People</code>, ou <code>null</code>.</p><h4 id="ref-tablekey" tabindex="-1"><code>Ref(tableKey)</code> <a class="header-anchor" href="#ref-tablekey" aria-label="Permalink to &quot;`Ref(tableKey)`&quot;">​</a></h4><p><code>Ref</code> est le paramètre du <code>callback</code> de <code>.addTables</code>. Il accepte comme paramètre le nom d&#39;une des tables déjà définies.</p><p>La valeur attendue par <code>Ref</code> est fortement typée : dans la définition de la table <code>Tasks</code> tout autre référence que Ref(&quot;People&quot;) ou Ref(&quot;Projects&quot;) sera rejetée par Typescript.</p><h3 id="populate-callback" tabindex="-1"><code>.populate(callback)</code> <a class="header-anchor" href="#populate-callback" aria-label="Permalink to &quot;`.populate(callback)`&quot;">​</a></h3><p>Peuple les tables avec des données spécifiques en utilisant des références à partir d&#39;une fonction callback.</p><p>Cette fonction reçoit en argument un objet contenant des constructeurs de références vers les tables précédemment définies.</p><p>Les valeurs des références sont également fortement typées :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C8C8C8;">Tasks</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#C8C8C8;">  task1</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#C8C8C8;">    title</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;Design Homepage&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#C8C8C8;">    assignedTo</span><span style="color:#D4D4D4;">: </span><span style="color:#DCDCAA;">People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;charlie&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#6A9955;">// ❌ Erreur : &quot;charlie&quot; n&#39;existe pas dans People</span></span>
<span class="line"><span style="color:#C8C8C8;">    project</span><span style="color:#D4D4D4;">: </span><span style="color:#DCDCAA;">Projects</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;proj1&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">  },</span></span>
<span class="line"><span style="color:#D4D4D4;">},</span></span></code></pre></div><p>Toute tentative d’ajouter une valeur non conforme entraîne une erreur Typescript avant même l’exécution du code.</p><h3 id="done" tabindex="-1"><code>.done()</code> <a class="header-anchor" href="#done" aria-label="Permalink to &quot;`.done()`&quot;">​</a></h3><p>Finalise la création du modèle en renvoyant des utilitaires pratiques permettant d&#39;interagir avec les tables créées.</p><p>Retourne notamment :</p><ul><li><code>tables</code>: les tables définies</li><li><code>initIds</code>: mapping entre les clés de populate (état initial) et leurs ids</li><li><code>create</code>: contient un créateur d&#39;entrée pour chaque table</li><li><code>select</code>: sélecteurs memoïsés pour les entrées</li><li><code>commit</code>: permet d&#39;effectuer des opérations create-update-delete sur le modèle</li><li><code>deepSelect</code>: sélecteurs pour les entrées en résolvant les référeces</li></ul><p>Chacun de ces éléments sont présentés en détails dans la partie suivante.</p><h2 id="exploitation-du-modele" tabindex="-1">Exploitation du modèle <a class="header-anchor" href="#exploitation-du-modele" aria-label="Permalink to &quot;Exploitation du modèle&quot;">​</a></h2><h3 id="tables" tabindex="-1">tables <a class="header-anchor" href="#tables" aria-label="Permalink to &quot;tables&quot;">​</a></h3><h4 id="structure-de-donnees" tabindex="-1">Structure de données <a class="header-anchor" href="#structure-de-donnees" aria-label="Permalink to &quot;Structure de données&quot;">​</a></h4><p><strong>Entry</strong></p><p>Les entrées des tables sont de type <code>Entry</code> avec :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Entry</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">Data</span><span style="color:#D4D4D4;">&gt; = { </span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">; </span><span style="color:#9CDCFE;">label</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">; </span><span style="color:#9CDCFE;">d</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Data</span><span style="color:#D4D4D4;"> };</span></span></code></pre></div><p><strong>Table</strong></p><p>Une <code>Table</code> contient deux propriétés :</p><ul><li><strong>entities</strong> : le dictionnaire des entrées de la table indexées par leur <code>id</code></li><li><strong>ids</strong>: la liste des ids de la table</li></ul><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Id</span><span style="color:#D4D4D4;"> = </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Table</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">Data</span><span style="color:#D4D4D4;">&gt; = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  entities</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Record</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">Id</span><span style="color:#D4D4D4;">, </span><span style="color:#4EC9B0;">Entry</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">Data</span><span style="color:#D4D4D4;">&gt;&gt;;</span></span>
<span class="line"><span style="color:#9CDCFE;">  ids</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Id</span><span style="color:#D4D4D4;">[];</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span></code></pre></div><p>L&#39;objet <strong>tables</strong> associe à chaque clé définie dans la méthode <code>.addTables</code> une table dont la <code>Data</code> est du type de la valeur associée.</p><p>Une <code>Table</code> est générée même si elle n&#39;est peuplée par aucune donnée à l&#39;aide de <code>.populate</code></p><p><strong>Exemple</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Table</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Number</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">SelfRef</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">tables</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#9CDCFE;">    People:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#9CDCFE;"> Number</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Projects:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    Tasks:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">assignedTo:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;People&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">project:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Projects&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">populate</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({}))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">done</span><span style="color:#D4D4D4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">{</span></span>
<span class="line"><span style="color:#6A9955;">  People: { entities: {}, ids: [] },</span></span>
<span class="line"><span style="color:#6A9955;">  Projects: { entities: {}, ids: []},</span></span>
<span class="line"><span style="color:#6A9955;">  Tasks: { entities: {}, ids: []}</span></span>
<span class="line"><span style="color:#6A9955;">}</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span></code></pre></div><h4 id="mapping-avec-populate" tabindex="-1">Mapping avec .populate <a class="header-anchor" href="#mapping-avec-populate" aria-label="Permalink to &quot;Mapping avec .populate&quot;">​</a></h4><p>Chaque entrée d&#39;une table définie dans populate est mappée avec le type <code>Entry</code> :</p><ul><li>id: identifiant unique généré aléatoirement (par défaut)</li><li>label: associé à la clé utilisée dans populate (par défaut)</li><li>d: valeur définie dans <code>populate</code></li></ul><p><strong>Avec l&#39;exemple initial</strong>:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">table</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">{</span></span>
<span class="line"><span style="color:#6A9955;">  People: { </span></span>
<span class="line"><span style="color:#6A9955;">    entities: {</span></span>
<span class="line"><span style="color:#6A9955;">      randomId1: { </span></span>
<span class="line"><span style="color:#6A9955;">        id: &quot;randomId1&quot;, </span></span>
<span class="line"><span style="color:#6A9955;">        label: &quot;alice&quot;, </span></span>
<span class="line"><span style="color:#6A9955;">        d: { name: &quot;Alice&quot;, age: 25, favouriteCoWorker: { $table: &quot;People&quot;, id: &quot;randomId2&quot; } } </span></span>
<span class="line"><span style="color:#6A9955;">      },</span></span>
<span class="line"><span style="color:#6A9955;">      randomId2: { </span></span>
<span class="line"><span style="color:#6A9955;">        id: &quot;randomId2&quot;, </span></span>
<span class="line"><span style="color:#6A9955;">        label: &quot;bob&quot;, </span></span>
<span class="line"><span style="color:#6A9955;">        d: { name: &quot;Bob&quot;, age: 30, favouriteCoWorker: null }</span></span>
<span class="line"><span style="color:#6A9955;">      },</span></span>
<span class="line"><span style="color:#6A9955;">      randomId3: { </span></span>
<span class="line"><span style="color:#6A9955;">        id: &quot;randomId3&quot;, </span></span>
<span class="line"><span style="color:#6A9955;">        label: &quot;james&quot;, </span></span>
<span class="line"><span style="color:#6A9955;">        d: { name: &quot;James&quot;, age: 26, favouriteCoWorker: { $table: &quot;People&quot;, id: &quot;randomId1&quot; } }</span></span>
<span class="line"><span style="color:#6A9955;">      }</span></span>
<span class="line"><span style="color:#6A9955;">    }, </span></span>
<span class="line"><span style="color:#6A9955;">    ids: [&quot;randomId1&quot;, &quot;randomId2&quot;, &quot;randomId3&quot;] </span></span>
<span class="line"><span style="color:#6A9955;">  },</span></span>
<span class="line"><span style="color:#6A9955;">  Projects: { </span></span>
<span class="line"><span style="color:#6A9955;">    entities: {</span></span>
<span class="line"><span style="color:#6A9955;">      randomId4: {</span></span>
<span class="line"><span style="color:#6A9955;">        id: &quot;randomId4&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">        label: &quot;proj1&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">        d: { title: &quot;Website Redesign&quot;, description: &quot;Revamp company site&quot; }</span></span>
<span class="line"><span style="color:#6A9955;">      }</span></span>
<span class="line"><span style="color:#6A9955;">    }, </span></span>
<span class="line"><span style="color:#6A9955;">    ids: [&quot;randomId4&quot;]</span></span>
<span class="line"><span style="color:#6A9955;">  },</span></span>
<span class="line"><span style="color:#6A9955;">  Tasks: { </span></span>
<span class="line"><span style="color:#6A9955;">    entities: {</span></span>
<span class="line"><span style="color:#6A9955;">      randomId5: {</span></span>
<span class="line"><span style="color:#6A9955;">        id: &quot;randomId5&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">        label: &quot;task1&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">        d: {</span></span>
<span class="line"><span style="color:#6A9955;">          title: &quot;Design Homepage&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">          assignedTo: { $table: &quot;People&quot;, id: &quot;randomId1&quot; },</span></span>
<span class="line"><span style="color:#6A9955;">          project: { $table: &quot;Projects&quot;, id: &quot;randomId4&quot;},</span></span>
<span class="line"><span style="color:#6A9955;">        },</span></span>
<span class="line"><span style="color:#6A9955;">      }</span></span>
<span class="line"><span style="color:#6A9955;">    }, </span></span>
<span class="line"><span style="color:#6A9955;">    ids: [&quot;randomId5&quot;]</span></span>
<span class="line"><span style="color:#6A9955;">  }</span></span>
<span class="line"><span style="color:#6A9955;">}</span></span>
<span class="line"><span style="color:#6A9955;"> */</span></span></code></pre></div><p>Les ids des références sont résolus pour générer les <code>Table</code>.</p><h4 id="tableoptions" tabindex="-1">TableOptions <a class="header-anchor" href="#tableoptions" aria-label="Permalink to &quot;TableOptions&quot;">​</a></h4><p>Il est possible de personnaliser le mapping des attributs <code>id</code> et <code>label</code> des <code>Entry</code>.</p><p>Il suffit pour cela de passer à <code>Tables</code> un objet de configuration de type :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> TableOptions</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#DCDCAA;">  id</span><span style="color:#D4D4D4;">?: (</span><span style="color:#9CDCFE;">entryKeyInPopulate</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#4EC9B0;"> string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#DCDCAA;">  label</span><span style="color:#D4D4D4;">?: (</span><span style="color:#9CDCFE;">entryKeyInPopulate</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#4EC9B0;"> string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span></code></pre></div><p>Cela permet notamment de générer des entrées avec des id déterministe à des fins de débogage.</p><p>L&#39;option par defaut (lorsqu&#39;aucun objet de configuration n&#39;est passé à Tables) est équivalente à :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#C8C8C8;">  id</span><span style="color:#D4D4D4;">: () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> randomIdGenerator</span><span style="color:#D4D4D4;">(),</span></span>
<span class="line"><span style="color:#C8C8C8;">  label</span><span style="color:#D4D4D4;">: (</span><span style="color:#9CDCFE;">entryKeyInPopulate</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> entryKeyInPopulate</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span></code></pre></div><h3 id="initids" tabindex="-1">initIds <a class="header-anchor" href="#initids" aria-label="Permalink to &quot;initIds&quot;">​</a></h3><p>Mappe les clés définies dans populate avec les ids associés.</p><p><strong>Exemple</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">initIds</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">{</span></span>
<span class="line"><span style="color:#6A9955;">  People: { alice: &quot;randomId1&quot;, bob: &quot;randomId2&quot;, james: &quot;randomId3&quot; },</span></span>
<span class="line"><span style="color:#6A9955;">  Projects: { proj1: &quot;randomId4&quot; },</span></span>
<span class="line"><span style="color:#6A9955;">  Tasks: { task1: &quot;randomId5&quot;}</span></span>
<span class="line"><span style="color:#6A9955;">}</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span></code></pre></div><h3 id="create" tabindex="-1"><code>create</code> <a class="header-anchor" href="#create" aria-label="Permalink to &quot;`create`&quot;">​</a></h3><p>create expose une méthode pour chaque table définie (ex. create.People, create.Tasks, etc.). Vous utilisez ces méthodes pour créer de nouvelles entrées dans la table correspondante.</p><ul><li><p>Callback de création :</p><p>Chaque méthode <code>create.&lt;TableKey&gt;</code> attend un callback qui reçoit en argument un objet contenant des constructeurs de références pour les tables du modèle. Ces constructeurs fonctionnent de manière similaire à ceux utilisés dans .populate, avec une différence essentielle : Ils nécessitent la spécification de l’identifiant final de l’entrée référencée. Cela permet de créer des références vers des entrées qui ne proviennent pas forcément de l’état initial.</p></li><li><p>Retour du callback :</p><p>Le callback doit renvoyer un objet dont la structure correspond exactement à celle définie lors de l’appel à .addTables pour la table concernée.</p></li><li><p>Métadonnées optionnelles : En second argument, vous pouvez fournir un objet de métadonnées :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> EntryMeta</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">; </span><span style="color:#9CDCFE;">label</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> };</span></span></code></pre></div><ul><li>id : Si non spécifié, un identifiant unique est généré automatiquement.</li><li>label : Par défaut, il est défini comme la concaténation <code>${TableKey}_${id}</code>. Ces métadonnées permettent de personnaliser l’identifiant et le label de l’entrée créée.</li></ul></li></ul><p><strong>Exemple</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#6A9955;">// Utilisation de create pour ajouter une nouvelle tâche</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> newTask</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">create</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">Tasks</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#6A9955;">  // Callback de création : les constructeurs de références requièrent un identifiant final</span></span>
<span class="line"><span style="color:#D4D4D4;">  ({ </span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Projects</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    title:</span><span style="color:#CE9178;"> &quot;Implement Authentication&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#6A9955;">    // On peut utiliser initIds pour référencer un id défini à l&#39;état initial</span></span>
<span class="line"><span style="color:#6A9955;">    // Il faudra vérifier qu&#39;il existe toujours dans la table au moment de l&#39;ajout de newTask</span></span>
<span class="line"><span style="color:#9CDCFE;">    assignedTo:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">alice</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#6A9955;">    // On peut également utiliser un id non défini dans l&#39;état initial</span></span>
<span class="line"><span style="color:#6A9955;">    // Il faudra de même vérifier qu&#39;il existe au moment de l&#39;ajout de newTask dans le modèle</span></span>
<span class="line"><span style="color:#9CDCFE;">    project:</span><span style="color:#DCDCAA;"> Projects</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;someIdOfProjectsTable&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#D4D4D4;">  }),</span></span>
<span class="line"><span style="color:#6A9955;">  // Métadonnées optionnelles pour définir l&#39;id et le label de la nouvelle tâche</span></span>
<span class="line"><span style="color:#D4D4D4;">  { </span><span style="color:#9CDCFE;">id:</span><span style="color:#CE9178;"> &quot;task2&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">label:</span><span style="color:#CE9178;"> &quot;newTask&quot;</span><span style="color:#D4D4D4;"> }</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newTask</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">Affichera une nouvelle entrée de type Entry pour la table Tasks, par exemple :</span></span>
<span class="line"><span style="color:#6A9955;">{</span></span>
<span class="line"><span style="color:#6A9955;">  id: &quot;task2&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">  label: &quot;newTask&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">  d: {</span></span>
<span class="line"><span style="color:#6A9955;">    title: &quot;Implement Authentication&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">    // randomId1 est l&#39;id de alice dans l&#39;exemple (obtenu par initIds.People.alice)</span></span>
<span class="line"><span style="color:#6A9955;">    assignedTo: { $table: &quot;People&quot;, id: &quot;randomId1&quot; },</span></span>
<span class="line"><span style="color:#6A9955;">    // randomId4 est l&#39;id de proj1 dans l&#39;exemple</span></span>
<span class="line"><span style="color:#6A9955;">    project: { $table: &quot;Projects&quot;, id: &quot;randomId4&quot; }</span></span>
<span class="line"><span style="color:#6A9955;">  }</span></span>
<span class="line"><span style="color:#6A9955;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">Si un second argument n&#39;avait pas été passé à create.Tasks alors les propriétés id et label</span></span>
<span class="line"><span style="color:#6A9955;">auraient été de la forme : {id: &quot;someRandomId&quot;, label: &quot;Tasks_someRandomId&quot;}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">*/</span></span></code></pre></div><h3 id="select" tabindex="-1"><code>select</code> <a class="header-anchor" href="#select" aria-label="Permalink to &quot;`select`&quot;">​</a></h3><p><code>select</code> expose pour chaque table définie un ensemble de sélecteurs, sous la forme :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">tableKey</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">selector</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">payload</span><span style="color:#D4D4D4;">);</span></span></code></pre></div><p>Voici la liste des sélecteurs exposés :</p><p>Avec payload:</p><ul><li><strong>byId</strong> : la payload est l&#39;id d&#39;une entrée de la table. Renvoie l&#39;entrée correspondante undefined si l’entrée n’existe pas.</li><li><strong>byIdExn</strong> : fonctionne comme byId mais lève une exception si l’entrée n’est pas trouvée.</li></ul><p>Sans payload:</p><ul><li><strong>entities</strong> : retourne le dictionnaire complet des entrées indexées par leur identifiant.</li><li><strong>all</strong> : fournit la liste complète des entrées de la table.</li><li><strong>total</strong> : renvoie le nombre total d’entrées dans la table.</li><li><strong>ids</strong> : renvoie la liste des identifiants de la table.</li></ul><p><strong>Ces sélecteurs prennent le modèle complet en paramètre mais ne sont recalculés que lorsque la table <code>tableKey</code> est modifiée.</strong></p><p><strong>Exemples d’utilisation de select</strong></p><p>Supposons que le modèle est défini de la manière suivante :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">SelfRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Number</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> model</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#9CDCFE;">    People:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#9CDCFE;"> Number</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Projects:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    Tasks:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">assignedTo:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;People&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">project:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Projects&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">populate</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Projects</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    People:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      alice:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;Alice&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 25</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;bob&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#9CDCFE;">      bob:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;Bob&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 30</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#569CD6;"> null</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">      james:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;James&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 26</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">favouriteCoWorker:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;alice&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Projects:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      proj1:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#CE9178;"> &quot;Website Redesign&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#CE9178;"> &quot;Revamp company site&quot;</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Tasks:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      task1:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &quot;Design Homepage&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">        assignedTo:</span><span style="color:#DCDCAA;"> People</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;alice&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#9CDCFE;">        project:</span><span style="color:#DCDCAA;"> Projects</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;proj1&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#D4D4D4;">      },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">done</span><span style="color:#D4D4D4;">();</span></span></code></pre></div><p>Avec ce modèle, nous disposons des utilitaires suivants dans select pour accéder aux données :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">tables</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">select</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 1. Récupérer une entrée de la table People par son id</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> aliceEntry</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">byId</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;randomId1&quot;</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Entrée d&#39;Alice :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">aliceEntry</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">d</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 2. Utiliser byIdExn pour récupérer une tâche (lève une exception si non trouvée)</span></span>
<span class="line"><span style="color:#C586C0;">try</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> taskEntry</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Tasks</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">byIdExn</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;randomId5&quot;</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">  console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Détails de la tâche :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">taskEntry</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">d</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;">} </span><span style="color:#C586C0;">catch</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#9CDCFE;">  console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">error</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Erreur, tâche non trouvée :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 3. Récupérer toutes les entrées de la table People</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> allPeople</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">all</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#CE9178;">  &quot;Liste de toutes les personnes :&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  allPeople</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">entry</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> entry</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">d</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 4. Obtenir le nombre total d&#39;entrées dans la table Projects</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> totalProjects</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Projects</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">total</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Nombre de projets :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">totalProjects</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 5. Récupérer les identifiants de toutes les entrées de la table Tasks</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> taskIds</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Tasks</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">ids</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Identifiants des tâches :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">taskIds</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 6. Accéder au dictionnaire complet des entrées pour People</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> peopleEntities</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">select</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">entities</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Dictionnaire des personnes :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">peopleEntities</span><span style="color:#D4D4D4;">);</span></span></code></pre></div><p>Ces exemples illustrent comment utiliser les sélecteurs pour :</p><ul><li>Accéder à une entrée précise via son identifiant (byId et byIdExn).</li><li>Récupérer l’ensemble des entrées d’une table (all et entities).</li><li>Obtenir des informations globales sur la table comme le nombre total d’entrées (total) ou la liste des identifiants (ids).</li></ul><h3 id="commit" tabindex="-1"><code>commit</code> <a class="header-anchor" href="#commit" aria-label="Permalink to &quot;`commit`&quot;">​</a></h3><p><code>commit</code> expose pour chaque table définie un ensemble de modificateurs permettant d’effectuer des opérations de création, mise à jour et suppression (create-update-delete) et renvoient le modèle. Ils sont de la forme :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">tableKey</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">method</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> model</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">payload</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// typeof model</span></span></code></pre></div><p>Les méthodes et leurs payload respectives sont :</p><ul><li><strong>addOne</strong>: accepte une seule entrée de la table et l&#39;ajoute si elle n&#39;existe pas déjà.</li><li><strong>addMany</strong>: accepte un tableau d&#39;entrées et les ajoute si elles ne sont pas déjà présentes.</li><li><strong>upsertOne</strong>: accepte une seule entrée complète. Si une entrée portant cet identifiant existe déjà, elle effectue une mise à jour profonde en fusionnant les nouveaux champs spécifiés dans l&#39;entité existante, les champs correspondants remplaçant les valeurs existantes. Si l&#39;entrée n&#39;existe pas encore, elle est ajoutée.</li><li><strong>upsertMany</strong>: accepte un tableau d&#39;entrées complète et réalise une insertion ou mise à jour profonde</li><li><strong>setOne</strong>: accepte une seule entrée, l&#39;ajoute ou la remplace.</li><li><strong>setMany</strong>: accepte un tableau d&#39;entrées et les ajoute ou les remplace.</li><li><strong>setAll</strong>: accepte un tableau d&#39;entrées et remplace toutes les entrées existantes par celles fournies.</li><li><strong>updateOne</strong>: accepte un objet de mise à jour contenant l&#39;identifiant de l&#39;entité et un objet changes avec les nouvelles valeurs des champs à mettre à jour, puis effectue une mise à jour profondes sur l&#39;entité correspondante</li><li><strong>updateMany</strong>: accepte un tableau d&#39;objets de mise à jour et effectue des mises à jour profondes sur toutes les entrées correspondantes.</li><li><strong>removeOne</strong>: accepte l&#39;identifiant (id) d&#39;une seule entrée et supprime l&#39;entrée correspondante si elle existe.</li><li><strong>removeMany</strong>: accepte un tableau d&#39;identifiants d&#39;entrées et supprime chacune des entrées correspondantes si elles existent.</li><li><strong>removeAll</strong>: supprime toutes les entrées d&#39;une table</li></ul><p>Les objets de mise à jour sont définis par <code>Update</code> :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Update</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">T</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> Entry</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">any</span><span style="color:#D4D4D4;">&gt;, </span><span style="color:#4EC9B0;">Id</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> EntityId</span><span style="color:#D4D4D4;">&gt; = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  id</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Id</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  changes</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">DeepPartial</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">T</span><span style="color:#D4D4D4;">&gt;;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span></code></pre></div><p><strong>Exemples</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#6A9955;">// Supposons que le modèle contient déjà la table People et que l&#39;on a extrait les utilitaires :</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">tables</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">initIds</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">commit</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">create</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 1 : Ajouter une nouvelle entrée dans la table People avec addOne.</span></span>
<span class="line"><span style="color:#6A9955;">  La nouvelle personne &#39;David&#39; est ajoutée avec une référence à &#39;Alice&#39; existante.</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> newPerson</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Entry</span><span style="color:#D4D4D4;">&lt;{</span></span>
<span class="line"><span style="color:#9CDCFE;">  name</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  age</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">number</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  favouriteCoWorker</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">}&gt; = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  id:</span><span style="color:#CE9178;"> &quot;person4&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  label:</span><span style="color:#CE9178;"> &quot;david&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  d:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &quot;David&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">    age:</span><span style="color:#B5CEA8;"> 28</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#6A9955;">    // On utilise ici la référence vers &#39;Alice&#39; (récupérée via initIds)</span></span>
<span class="line"><span style="color:#9CDCFE;">    favouriteCoWorker:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">$table:</span><span style="color:#CE9178;"> &quot;People&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">id:</span><span style="color:#9CDCFE;"> initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">alice</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">  },</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterAdd</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addOne</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">newPerson</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 2 : Ajouter plusieurs projets en une seule opération avec addMany.</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> project2</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Entry</span><span style="color:#D4D4D4;">&lt;{ </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">; </span><span style="color:#9CDCFE;">description</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> }&gt;[] = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  id:</span><span style="color:#CE9178;"> &quot;proj2&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  label:</span><span style="color:#CE9178;"> &quot;project2&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  d:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">title:</span><span style="color:#CE9178;"> &quot;New Mobile App&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">description:</span><span style="color:#CE9178;"> &quot;Develop a mobile application&quot;</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Il est bien sûr possible d&#39;utiliser create</span></span>
<span class="line"><span style="color:#6A9955;">// un id aléatoire est ici généré car non précisé</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> project3</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">create</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">Projects</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#D4D4D4;">  () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    title:</span><span style="color:#CE9178;"> &quot;API Integration&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">    description:</span><span style="color:#CE9178;"> &quot;Integrate third-party APIs&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">  }),</span></span>
<span class="line"><span style="color:#D4D4D4;">  { </span><span style="color:#9CDCFE;">label:</span><span style="color:#CE9178;"> &quot;project3&quot;</span><span style="color:#D4D4D4;"> }</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterAddMany</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Projects</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addMany</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tablesAfterAdd</span><span style="color:#D4D4D4;">, [</span></span>
<span class="line"><span style="color:#9CDCFE;">  project2</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  project3</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 3 : Mettre à jour l&#39;âge de Bob en utilisant updateOne.</span></span>
<span class="line"><span style="color:#6A9955;">  Ici, on met à jour seulement la propriété `age` dans `d` pour l&#39;entrée correspondant à Bob.</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterUpdate</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">updateOne</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tablesAfterAddMany</span><span style="color:#D4D4D4;">, {</span></span>
<span class="line"><span style="color:#9CDCFE;">  id:</span><span style="color:#9CDCFE;"> initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">bob</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  changes:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">d:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 31</span><span style="color:#D4D4D4;"> } },</span></span>
<span class="line"><span style="color:#D4D4D4;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 4 : Mise à jour de plusieurs entrées dans People avec updateMany.</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterUpdateMany</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">updateMany</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tablesAfterUpdate</span><span style="color:#D4D4D4;">, [</span></span>
<span class="line"><span style="color:#D4D4D4;">  { </span><span style="color:#9CDCFE;">id:</span><span style="color:#9CDCFE;"> initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">alice</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">changes:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">d:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 26</span><span style="color:#D4D4D4;"> } } },</span></span>
<span class="line"><span style="color:#D4D4D4;">  { </span><span style="color:#9CDCFE;">id:</span><span style="color:#9CDCFE;"> initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">james</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">changes:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">d:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 27</span><span style="color:#D4D4D4;"> } } },</span></span>
<span class="line"><span style="color:#D4D4D4;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 5 : Supprimer une entrée dans la table Tasks avec removeOne.</span></span>
<span class="line"><span style="color:#6A9955;">  Ici, on supprime la tâche identifiée par initIds.Tasks.task1.</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterDelete</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Tasks</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeOne</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#9CDCFE;">  tablesAfterUpdateMany</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Tasks</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">task1</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 6 : Supprimer plusieurs entrées en fournissant un tableau d&#39;identifiants avec removeMany.</span></span>
<span class="line"><span style="color:#6A9955;">  (Supposons que l&#39;on veuille supprimer plusieurs personnes)</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterRemoveMany</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeMany</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tablesAfterDelete</span><span style="color:#D4D4D4;">, [</span></span>
<span class="line"><span style="color:#9CDCFE;">  initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">alice</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">People</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">james</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">  Exemple 7 : Supprimer toutes les entrées d&#39;une table avec removeAll.</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tablesAfterRemoveAll</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Projects</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeAll</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tablesAfterRemoveMany</span><span style="color:#D4D4D4;">);</span></span></code></pre></div><h3 id="deepselect" tabindex="-1"><code>deepSelect</code> <a class="header-anchor" href="#deepselect" aria-label="Permalink to &quot;`deepSelect`&quot;">​</a></h3><p><code>deepSelect</code> permet de récupérer la donnée (attribut d) d&#39;une <code>Entry</code> en résolvant de manière récursive toutes les références contenues dans ses champs. Autrement dit, au lieu d’obtenir des objets de référence de la forme <code>{ $table: &quot;TableKey&quot;, id: &quot;someId&quot; }</code>, <code>deepSelect</code> remplace chaque référence par la donnée d de l’entrée correspondante, avec ses propres références résolues à leur tour. La récursion se coupe au niveau des <code>SelfRef</code> de sorte à éviter les récursions infinies.</p><h4 id="syntaxe" tabindex="-1">Syntaxe <a class="header-anchor" href="#syntaxe" aria-label="Permalink to &quot;Syntaxe&quot;">​</a></h4><p>De même les sélecteurs se déclinent :</p><ul><li><p>Avec payload :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">deepSelect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">tableKey</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">selector</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">payload</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">depth</span><span style="color:#D4D4D4;">?: </span><span style="color:#9CDCFE;">number</span><span style="color:#D4D4D4;">);</span></span></code></pre></div><ul><li><strong>byId</strong> : accepte comme payload un id et renvoie une <code>deepEntry</code> ou <code>undefined</code> si aucune entrée ne correspond à l&#39;id.</li><li><strong>byIdExn</strong>: fonctionne comme byId mais lève une exception si l’entrée n’est pas trouvée.</li></ul></li><li><p>Sans payload :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">deepSelect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">tableKey</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">selector</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">depth</span><span style="color:#D4D4D4;">?: </span><span style="color:#9CDCFE;">number</span><span style="color:#D4D4D4;">);</span></span></code></pre></div><ul><li><strong>entities</strong> : retourne le dictionnaire complet des entrées résolues indexées par leur identifiant.</li><li><strong>all</strong> : fournit la liste complète des entrées résolues de la table.</li></ul></li></ul><p>Le paramètre optionnel <code>depth</code>, permet de limiter la profondeur de récursion, elle vaut par défaut 10.</p><h4 id="deepentry" tabindex="-1">DeepEntry <a class="header-anchor" href="#deepentry" aria-label="Permalink to &quot;DeepEntry&quot;">​</a></h4><p>Le type auxiliaire <code>DeepEntry</code> est exporté par <code>relatix</code> :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">DeepEntry</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span></code></pre></div><p>Il prend en paramètre le type des tables et une clé et renvoie le type correspondant, en coupant la récursion au niveau des SelfRef (remplacée par des DataRef).</p><p><strong>Exemples</strong></p><p>Les types :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Person</span><span style="color:#D4D4D4;"> = </span><span style="color:#4EC9B0;">DeepEntry</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> tables</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;People&quot;</span><span style="color:#D4D4D4;">&gt;;</span></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Project</span><span style="color:#D4D4D4;"> = </span><span style="color:#4EC9B0;">DeepEntry</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> tables</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;Projects&quot;</span><span style="color:#D4D4D4;">&gt;;</span></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Task</span><span style="color:#D4D4D4;"> = </span><span style="color:#4EC9B0;">DeepEntry</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> tables</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;Tasks&quot;</span><span style="color:#D4D4D4;">&gt;;</span></span></code></pre></div><p>Sont respectivement égaux à :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Person</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  name</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  age</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">number</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  favouriteCoWorker</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">DataRef</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#CE9178;">&quot;People&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">&gt; | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Project</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  title</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  description</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#4EC9B0;"> Task</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#9CDCFE;">  title</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">  assignedTo</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;">    name</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">    age</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">number</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">    favouriteCoWorker</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">DataRef</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#CE9178;">&quot;People&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">&gt; | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// Recursion coupée ici</span></span>
<span class="line"><span style="color:#D4D4D4;">  };</span></span>
<span class="line"><span style="color:#9CDCFE;">  project</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;">    title</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#9CDCFE;">    description</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">  };</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span></code></pre></div><h4 id="utilite-de-deepselect" tabindex="-1">Utilité de deepSelect <a class="header-anchor" href="#utilite-de-deepselect" aria-label="Permalink to &quot;Utilité de deepSelect&quot;">​</a></h4><p>Dans certains cas, vos données peuvent représenter des structures composites où une entité se définit en partie par d’autres entités. Par exemple, une forme géométrique complexe peut être constituée d’un contour défini par une ligne, et cette ligne est elle-même définie par deux points. Avec deepSelect, vous pouvez obtenir directement l’objet final avec l’ensemble de ses composants entièrement résolus, facilitant ainsi l’analyse et la manipulation de vos données.</p><p><strong>Exemple : Entités géométriques composables</strong> Imaginons un modèle comportant trois tables :</p><ul><li>Points : définit un point par ses coordonnées.</li><li>Lines : définit une ligne à partir de deux points (début et fin).</li><li>CompositeShapes : définit une forme géométrique qui possède un nom, un contour (défini par une ligne) et, éventuellement, une référence à une autre forme (pour composer des formes complexes).</li></ul><p>Voici un exemple de configuration utilisant ces tables :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Tables</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">SelfRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Text</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Number</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;relatix&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> model</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Tables</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#9CDCFE;">    Points:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">x:</span><span style="color:#9CDCFE;"> Number</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#9CDCFE;"> Number</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Lines:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">pointA:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Points&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">pointB:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Points&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">addTables</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">Ref</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    CompositeShapes:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      name:</span><span style="color:#9CDCFE;"> Text</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#6A9955;">      // La propriété &#39;outline&#39; référence une ligne définissant le contour de la forme</span></span>
<span class="line"><span style="color:#9CDCFE;">      outline:</span><span style="color:#DCDCAA;"> Ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Lines&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#6A9955;">      // La propriété &#39;subShape&#39; permet de composer une forme à partir d&#39;une autre (optionnelle)</span></span>
<span class="line"><span style="color:#9CDCFE;">      subShape:</span><span style="color:#9CDCFE;"> SelfRef</span><span style="color:#D4D4D4;"> | </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">populate</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">Points</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Lines</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">CompositeShapes</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span>
<span class="line"><span style="color:#9CDCFE;">    Points:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">      p1:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">      p2:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">      p3:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#9CDCFE;">      p4:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    Lines:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#6A9955;">      // Ligne reliant p1 à p2</span></span>
<span class="line"><span style="color:#9CDCFE;">      l1:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">pointA:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p1&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">pointB:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p2&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#6A9955;">      // Ligne reliant p2 à p3</span></span>
<span class="line"><span style="color:#9CDCFE;">      l2:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">pointA:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p2&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">pointB:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p3&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#6A9955;">      // Autres lignes pour compléter un contour (non utilisées par deepSelect dans cet exemple)</span></span>
<span class="line"><span style="color:#9CDCFE;">      l3:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">pointA:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p3&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">pointB:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p4&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#9CDCFE;">      l4:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">pointA:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p4&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">pointB:</span><span style="color:#DCDCAA;"> Points</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p1&quot;</span><span style="color:#D4D4D4;">) },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#9CDCFE;">    CompositeShapes:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#6A9955;">      // Une forme simple (un carré) utilisant la ligne l1 pour son contour</span></span>
<span class="line"><span style="color:#9CDCFE;">      cs1:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &quot;Square&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">outline:</span><span style="color:#DCDCAA;"> Lines</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;l1&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">subShape:</span><span style="color:#569CD6;"> null</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#6A9955;">      // Une forme complexe qui compose le carré cs1 et utilise la ligne l2 pour son propre contour</span></span>
<span class="line"><span style="color:#9CDCFE;">      cs2:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">        name:</span><span style="color:#CE9178;"> &quot;Complex Square&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">        outline:</span><span style="color:#DCDCAA;"> Lines</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;l2&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#9CDCFE;">        subShape:</span><span style="color:#DCDCAA;"> CompositeShapes</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;cs1&quot;</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#D4D4D4;">      },</span></span>
<span class="line"><span style="color:#D4D4D4;">    },</span></span>
<span class="line"><span style="color:#D4D4D4;">  }))</span></span>
<span class="line"><span style="color:#D4D4D4;">  .</span><span style="color:#DCDCAA;">done</span><span style="color:#D4D4D4;">();</span></span></code></pre></div><p>Grâce à deepSelect, il est possible de récupérer l’entrée d’une forme composite avec toutes ses références résolues. Par exemple, pour récupérer la forme cs2 (la forme complexe), on peut utiliser le sélecteur byIdExn de deepSelect :</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki dark-plus vp-code" tabindex="0"><code><span class="line"><span style="color:#6A9955;">// Récupère l&#39;entrée &#39;cs2&#39; avec toutes ses références résolues</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> deepCompositeShape</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">model</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">deepSelect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">CompositeShapes</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">byIdExn</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#9CDCFE;">  model</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">tables</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  model</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">initIds</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">CompositeShapes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">cs2</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Forme composite résolue :&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">deepCompositeShape</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">/*</span></span>
<span class="line"><span style="color:#6A9955;">{</span></span>
<span class="line"><span style="color:#6A9955;">  name: &quot;ComplexSquare&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">  outline: {</span></span>
<span class="line"><span style="color:#6A9955;">    pointA: { x: 10, y: 0 },</span></span>
<span class="line"><span style="color:#6A9955;">    pointB: { x: 10, y: 10},</span></span>
<span class="line"><span style="color:#6A9955;">  },</span></span>
<span class="line"><span style="color:#6A9955;">  subShape: {</span></span>
<span class="line"><span style="color:#6A9955;">    name: &quot;Square&quot;,</span></span>
<span class="line"><span style="color:#6A9955;">    outline: {</span></span>
<span class="line"><span style="color:#6A9955;">      pointA: { x: 0, y: 0 },</span></span>
<span class="line"><span style="color:#6A9955;">      pointB: { x: 10, y: 0 }</span></span>
<span class="line"><span style="color:#6A9955;">    },</span></span>
<span class="line"><span style="color:#6A9955;">    subShape: null</span></span>
<span class="line"><span style="color:#6A9955;">  }</span></span>
<span class="line"><span style="color:#6A9955;">}</span></span>
<span class="line"><span style="color:#6A9955;">*/</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/relatix-docs/en/intro.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Intro</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"en_intro.md\":\"BK1Hp1kL\",\"en_modeling.md\":\"Dw8_9BN_\",\"en_usage.md\":\"D2BPQ6Td\",\"en_workflow.md\":\"BSz8xJnN\",\"fr_intro.md\":\"Dw0lpHsQ\",\"fr_modeling.md\":\"BiOjeG9z\",\"fr_tables.md\":\"DYrj6HwM\",\"fr_usage.md\":\"DgigfD_N\",\"fr_workflow.md\":\"CFeuDM6B\",\"index.md\":\"H9OHulbE\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Relatix\",\"description\":\"Relatix technical docs\",\"base\":\"/relatix-docs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"relatix-logo.png\",\"sidebar\":[{\"text\":\"Relatix\",\"items\":[{\"text\":\"Intro\",\"link\":\"/en/intro\"},{\"text\":\"Workflow\",\"link\":\"/en/workflow\"},{\"text\":\"Modeling\",\"link\":\"/en/modeling\"},{\"text\":\"Model Usage\",\"link\":\"/en/usage\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/relatixjs/relatix\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>